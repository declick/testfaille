<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Page with Vulnerabilities</title>
</head>
<body>
    <h1>Test Page with Unintentional Security Issues</h1>

    <form action="" method="get">
        <label for="searchInput">Enter something to search:</label>
        <input type="text" id="searchInput" name="search">
        <button type="submit">Search</button>
    </form>

    <div>
        <h3>Search Results:</h3>
        <p>
            <!-- Unescaped GET parameter could lead to XSS -->
            You searched for: <span id="searchResult"></span>
        </p>
    </div>

    <!-- Form to submit a message (potential XSS vulnerability) -->
    <form action="" method="post">
        <label for="messageInput">Your Message:</label>
        <input type="text" id="messageInput" name="message">
        <button type="submit">Submit</button>
    </form>

    <div>
        <h3>Submitted Messages:</h3>
        <p id="messageDisplay">
            <!-- Vulnerable to XSS if not sanitized -->
            <%= message %>
        </p>
    </div>

    <script>
        // Unescaped user input directly inserted into the DOM (XSS risk)
        const urlParams = new URLSearchParams(window.location.search);
        const searchQuery = urlParams.get('search');
        if (searchQuery) {
            document.getElementById('searchResult').innerHTML = searchQuery; // XSS risk
        }
    </script>

    <script>
        // SQLi risk via query parameters
        const urlParams = new URLSearchParams(window.location.search);
        const userId = urlParams.get('user_id');
        if (userId) {
            // Potentially unsafe SQL query construction
            fetch(`/user?id=${userId}`); // Potential SQL injection vulnerability
        }
    </script>
</body>
</html>
