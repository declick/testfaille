<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Page avec des Failles XSS</title>
</head>
<body>
    <h1>Exemple de Page Vulnérable à XSS</h1>

    <!-- Formulaire de recherche avec une faille XSS -->
    <form action="" method="get">
        <label for="searchInput">Rechercher quelque chose :</label>
        <input type="text" id="searchInput" name="search">
        <button type="submit">Chercher</button>
    </form>

    <!-- Affichage des résultats de recherche sans échappement -->
    <div>
        <h3>Résultats de recherche :</h3>
        <p>
            Vous avez cherché : <span id="searchResult"></span>
        </p>
    </div>

    <!-- Exemple de XSS avec une méthode dangereuse -->
    <button onclick="showAlert()">Cliquez pour afficher un message</button>

    <script>
        // Faute : Utilisation de innerHTML pour afficher une entrée utilisateur sans validation
        const urlParams = new URLSearchParams(window.location.search);
        const searchQuery = urlParams.get('search');
        if (searchQuery) {
            document.getElementById('searchResult').innerHTML = searchQuery;  // XSS vulnérable ici
        }

        // Faute : Utilisation de eval() pour exécuter une entrée utilisateur sans validation
        function unsafeEval() {
            const userInput = prompt("Entrez un code JavaScript");
            eval(userInput);  // XSS vulnérable avec eval
        }

        // Faute : Utilisation de document.write() pour afficher des données sans validation
        function unsafeWrite() {
            const userText = prompt("Entrez un texte");
            document.write(userText);  // XSS vulnérable avec document.write()
        }

        // Faute : Utilisation de setTimeout avec une entrée utilisateur non filtrée
        function unsafeTimeout() {
            const userInput = prompt("Entrez du texte à afficher après 3 secondes");
            setTimeout(() => alert(userInput), 3000);  // XSS vulnérable avec setTimeout
        }

        // Faute : Modification de window.location avec une entrée utilisateur non filtrée
        function unsafeLocation() {
            const userInput = prompt("Entrez une URL");
            window.location = userInput;  // XSS vulnérable avec window.location
        }

        // Bouton pour tester eval
        function showAlert() {
            unsafeEval();
        }
    </script>

</body>
</html>
